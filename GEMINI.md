# Project Overview

This is a mobile-first web application for finding and reviewing dog parks. It is built with React, TypeScript, Vite, and Capacitor, with Supabase as the backend.

The app is available on the web at [klavhub.com](https://klavhub.com) and in the app stores as "KlavHub".

## Building and Running

To get started with the project, run the following commands:

- `npm install`: Install dependencies.
- `npm run dev`: Start the development server.
- `npm run build`: Build the app for production.
- `npm run test`: Run the test suite.
- `npm run lint`: Lint the codebase.
- `npm run format`: Format the code using Prettier.

## Development Conventions

### Code Style

- The project uses Prettier for code formatting.
- The project uses ESLint for linting.
- The project uses SCSS modules for styling.
- The project uses `classnames` to conditionally join class names together.

### Architecture

- The app uses a component-based architecture with React.
- Routing is handled by `react-router-dom`.
- State management is handled with a combination of React Context and `zustand`.
- Data fetching is handled by `react-query`.
- The app is built with Capacitor to allow it to be deployed as a native mobile app.

### React Query

- The `react-query` client is initialized and exported from `src/services/react-query.ts`.
- When needing to interact with the query client (e.g., for cache invalidation), import the `queryClient` instance directly from this file instead of using the `useQueryClient` hook.

### Testing

- The project uses `vitest` for testing.
- Tests are located in the `src` directory alongside the files they test.
- The project uses `react-testing-library` for testing React components.

## Directory Structure

- **`.claude`**: Contains settings and commands for the Claude AI assistant.
- **`.gemini`**: Contains settings for the Gemini AI assistant.
- **`android`**: Contains the native Android project generated by Capacitor. You'll open this directory in Android Studio to build and run the app on Android.
- **`assets`**: Contains static assets for the app, such as the icon and splash screen.
- **`icons`**: Contains the app icons for different resolutions.
- **`ios`**: Contains the native iOS project generated by Capacitor. You'll open this directory in Xcode to build and run the app on iOS.
- **`public`**: Contains public assets that are copied directly to the `dist` directory without being processed by Vite. This includes the `favicon`, `manifest.webmanifest`, and `index.html`.
- **`src`**: This is where the main application source code lives. It's further divided into:
    - **`components`**: Reusable React components.
    - **`context`**: React context providers for managing global state.
    - **`hooks`**: Custom React hooks. Each hook should be in its own file within `src/hooks/api`.
    - **`loaders`**: Data loaders for `react-router-dom`.
    - **`pages`**: The main pages of the application.
    - **`services`**: Services for interacting with external APIs, such as Supabase.
    - **`types`**: TypeScript type definitions.
    - **`utils`**: Utility functions.
- **`supabase`**: Contains the Supabase database migrations and functions.

## Code Standards

### `tsx` Files

- **Component Definition**: Components are defined as functional components using `React.FC` or directly as functions.
- **Props**:
    - Props are defined using an `interface`.
    - Props interfaces are named `[ComponentName]Props`.
    - Props are destructured at the beginning of the component.
- **Styling**:
    - Styling is done using SCSS modules.
    - The styles are imported as `styles` from a `.[module].scss` file.
    - `classnames` library is used to conditionally apply classes.
- **Class Names**: Class names are written in `camelCase`.
- **Export**: All exports should be grouped at the end of the file using a single `export { ... };` statement.
- **File Naming**: Component files are named in `PascalCase.tsx`.

### `ts` Files

- **Typing**:
    - Types are used extensively.
    - Custom types are defined in the `src/types` directory.
- **Functions**:
    - Functions are defined using the `const functionName = () => {}` syntax.
    - Functions in services that accept more than 1 argument should accept an object of arguments.
    - The interface for these arguments should be named `[FunctionName]Params`, using PascalCase for the function name.
- **Error Handling**:
    - Service functions must wrap asynchronous calls in a `try...catch` block.
    - The `catch` block determines how to handle the error based on the specific needs of the function.
    - If the error needs to be propagated to the UI layer (e.g., for `react-query` to manage its error state), the `throwError` utility from `src/services/error.ts` must be used.
    - If the error can be handled gracefully within the service, the `catch` block should `console.error` the error and return an appropriate default value (e.g., `null`, an empty array `[]`).
- **Async/Await**: `async/await` is used for asynchronous operations.
- **Constants**: Use the `src/utils/consts.ts` file for shared constants when possible.
- **Export**: All exports should be grouped at the end of the file using a single `export { ... };` statement.
- **File Naming**: Files are named in `camelCase.ts` or `kebab-case.ts`.
- **Supabase**:
    - The Supabase client is imported from `src/services/supabase-client.ts`.
    - Supabase queries are used to interact with the database.

### Hooks

- Each hook should be in its own file.
- Hooks that are API-related should be under the `src/hooks/api` folder.

### `scss` Files

- **Syntax**: SCSS syntax is used.
- **Modules**: SCSS modules are used to scope styles to components.
- **File Naming**: Files are named `[ComponentName].module.scss`.
- **Class Names**: Class names are written in `kebab-case`.
- **Variables**:
    - Variables are defined in `src/variables.scss`.
    - Variables are imported using `@use '../variables' as *;`.
    - CSS custom properties (variables) are also used, likely for dynamic theming.
- **Nesting**: SCSS nesting is used to show hierarchy.
- **Units**: `px` is used for sizing.